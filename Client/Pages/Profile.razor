@page "/profile"
@using Concerto.Shared.Models
@using Microsoft.AspNetCore.Authorization
@inject HttpClient Http

@attribute [Authorize]

<PageTitle>Profile</PageTitle>

<h1>Your profile</h1>

@if (userData == null)
{
	<MudProgressCircular Color="Color.Default" Indeterminate="true" />
}
else
{

	<MudStack>
		<MudPaper Class="pa-4">
			<MudStack Row="true">
				<MudIcon Icon="@Icons.Material.Filled.Person" />
				<MudStack Justify="Justify.Center" Spacing="0">
					<MudText Typo="Typo.body1">@userData.Username</MudText>
					<MudText Typo="Typo.body2">Placeholder</MudText>
				</MudStack>
			</MudStack>
		</MudPaper>

		<MudPaper Class="pa-4">
			<MudStack Row="true">
				<MudIcon Icon="@Icons.Material.Filled.TableRows" Title="Details" />

				<MudStack Justify="Justify.Center" Spacing="4">
					<MudStack Justify="Justify.Center" Spacing="0">
						<MudText Typo="Typo.body1">User Id</MudText>
						<MudText Class="pl-2" Typo="Typo.body2">@userData.UserId</MudText>
					</MudStack>

					<MudStack Justify="Justify.Center" Spacing="0">
						<MudText Typo="Typo.body1">First name</MudText>
						<MudText Class="pl-2" Typo="Typo.body2">@userData.FirstName</MudText>
					</MudStack>

					<MudStack Justify="Justify.Center" Spacing="0">
						<MudText Typo="Typo.body1">Last name</MudText>
						<MudText Class="pl-2" Typo="Typo.body2">@userData.LastName</MudText>
					</MudStack>
				</MudStack>
			</MudStack>
		</MudPaper>
	</MudStack>
}


@code {
	private Dto.User? userData;

	protected override async Task OnInitializedAsync()
	{
		userData = await Http.GetFromJsonAsync<Dto.User?>("User/GetCurrentUser");
	}
}